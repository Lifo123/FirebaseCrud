import{j as c}from"./jsx-runtime.CdUEbdov.js";import{a as w,u as N}from"./index.Cd4NzlIq.js";import{r as p}from"./index.YZ_XhM9s.js";import{D as V,G as k,H as D,r as x,g as G,s as L}from"./index.esm2017.enH01Utu.js";import{g as A}from"./Hashing.Co_4HAtW.js";import{L as R}from"./Loading.CtAIUNYt.js";/* empty css                       */const b=typeof window<"u",g={gameState:{word:"",salt:"",guess:"",valid:[[{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null}],[{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null}],[{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null}]],status:"inProgress"},gameSettings:{Length:5,Tries:3,Language:"ES"}},y={tries:0,success:0,fails:0},f=w(b?JSON.parse(localStorage.getItem("F-Shuffle")||JSON.stringify(g)):g);w(b?JSON.parse(localStorage.getItem("F-ShuffleStadistic")||JSON.stringify(y)):y);const v={apiKey:"AIzaSyAwmC0jcBFmuMxYJaGS1wjdiuOSPYYSZWo",authDomain:"dictionaries-15fdf.firebaseapp.com",databaseURL:"https://dictionaries-15fdf-default-rtdb.firebaseio.com",projectId:"dictionaries-15fdf",storageBucket:"dictionaries-15fdf.appspot.com",messagingSenderId:"250956565323",appId:"1:250956565323:web:494f59d70d787ecc7c36ce",measurementId:"G-S3KRN2E2FZ"},E=V(v),I=k(E);D(E);const O=(e,n)=>{const t=h(e);if(t.length===1){localStorage.setItem(t[0],JSON.stringify(n));return}const o=t[0],a=localStorage.getItem(o);let s=a?JSON.parse(a):{},r=s;for(let l=1;l<t.length;l++){const i=t[l];l===t.length-1?r[i]=n:r[i]?r=r[i]:r[i]={}}return localStorage.setItem(o,JSON.stringify(s)),s},J=e=>{const n=h(e),t=n[0],o=localStorage.getItem(t);if(!o)return console.log("Storage not found"),null;let a=JSON.parse(o),s=a;for(let r=1;r<n.length;r++){const l=n[r];if(!s[l])return console.log("Node not found"),null;s=s[l]}return{storage:a,content:s}},B=e=>{if(!localStorage.getItem(e)){console.log("Storage not found");return}localStorage.removeItem(e)},C=(e,{value:n,obj:t})=>{const o=h(e);if(o.length===1)return t[o[0]]=n,t;let a=t;for(let s=0;s<o.length;s++){const r=o[s],l=!isNaN(Number(r));s===o.length-1?l?(Array.isArray(a)||(a=[]),a[Number(r)]=n):a[r]=n:l?(Array.isArray(a[r])||(a[r]=[]),a=a[r]):(a[r]||(a[r]={}),a=a[r])}return t},F=(e,{value:n,obj:t})=>{const o=e.split("/")[0],a=e.split("/").slice(1).join().split(",");if(a.length!==n.length)throw new Error("El número de valores no coincide con el número de nodos.");let s={...t},r=s[o]?{...s[o]}:{};for(let l=0;l<a.length;l++){const i=a[l].trim();r[i]=n[l]}return s[o]=r,s},h=e=>{e.endsWith("/")&&(e=e.slice(0,-1));const n=e.split("/").filter(t=>t!=="");return n.length>0?n:[]},u={set:O,get:J,remove:B,updateNode:C,updateNodes:F},W=(e,n)=>{const t=e.length+n.length,o=Array.from(n).reduce((i,d)=>i+d.charCodeAt(0),0);let a=e.split("").sort((i,d)=>i.localeCompare(d)),s=a.slice(0,Math.floor(a.length/2)),r=a.slice(Math.floor(a.length/2));for(let i=0;i<t;i++){const d=i%s.length,S=(i+o)%r.length;[s[d],r[S]]=[r[S],s[d]]}const l=[...s,...r];return{word:e,shuffle:l.join("")}},$=e=>Math.floor(Math.random()*((e||100)+1)),j={shuffle:W,generateRandom:$},K=async(e,n)=>{try{const t=x(I,`${e}/gameDefault/d${n}`),a=(await G(t)).val(),s=j.generateRandom(a.length);return console.log(a[s]),a[s]}catch(t){throw console.log("Error fetching word:",t),t}},M=async(e,n)=>{},z=async(e,n,t)=>{try{const o=x(I,`${e}/${n}`);return await L(o,t),console.log("Custom Dictionary set successfully"),!0}catch(o){throw console.log("Error setting custom Dictionary: ",o),o}},P={getWord:K,validateWord:M,setCustomDictionary:z},U=e=>{f.get()},H=()=>{console.log("Escribiendo")},Y=()=>{console.log("Escribiendo")},m={typing:U,backspace:H,enter:Y};function Z(){const e=N(f),n=async()=>{try{const s=A(),r=await P.getWord(e.gameSettings.Language,e.gameSettings.Length),l=j.shuffle(r,s);let i=u.updateNodes("gameState/word,salt",{value:[l.shuffle,s],obj:e});return await f.set(i),await u.set("F-Shuffle",i),!0}catch(s){return console.log(s),!1}},t=()=>{n()},o=()=>{f.set(g),u.set("F-Shuffle",g)},a=s=>{/^[a-zA-ZñÑ]$/.test(s.key)&&m.typing(s.key),s.key==="Backspace"&&m.backspace(),s.key==="Enter"&&m.enter()};return p.useEffect(()=>(window?.addEventListener("keydown",a),()=>{window?.removeEventListener("keydown",a)}),[]),p.useEffect(()=>{(e?.gameState?.word===""||e?.gameState?.salt==="")&&n()},[e?.gameState?.word,e?.gameState?.salt]),{getWord:n,restartGame:t,restartSettings:o}}function oe(){const e=N(f);Z();const n=async()=>{let t="";console.log(document.referrer),document.referrer?t=new URL(document.referrer).host:console.log("No hay URL anterior disponible.");const o=window.location.host;t&&t===o?console.log("Los hosts son iguales."):t&&console.log("Los hosts son diferentes.")};return c.jsxs("section",{className:"game-container f-col g-2 mt-5 mx-auto",children:[e?.gameState?.word?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"game-header f-row g-2 mx-auto",children:e.gameState.word.split("").map((t,o)=>c.jsx("span",{className:"box-in br-6 f-center fs-6 fw-900",children:t},o))}),c.jsx("div",{className:"game-board f-col g-2 mx-auto mt-3",children:e.gameState.valid.map((t,o)=>c.jsx(q,{data:t,id:o},o))})]}):c.jsx(R,{styleParent:{scale:"0.45",marginBottom:10},line:{strokeWidth:8}}),c.jsx("span",{className:"btn btn-blue br-6 w-max mt-5",onClick:n,children:"Generate New"})]})}const q=({data:e,id:n})=>c.jsx("div",{className:"game-row f-row g-2","data-row":n,children:e?.map((t,o)=>c.jsx("span",{className:"box-in br-6 f-center fs-6 fw-900","data-char":o,children:t.char},o))});export{oe as default};
