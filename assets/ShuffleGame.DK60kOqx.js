import{j as o}from"./jsx-runtime.CdUEbdov.js";import{a as S,u as N}from"./index.Cd4NzlIq.js";import{r as d}from"./index.YZ_XhM9s.js";import{D as P,G as D,H as $,r as x,g as I,s as j}from"./index.esm2017.enH01Utu.js";import{J as y}from"./_astro-entry_sonner.BrdQ6kbN.js";/* empty css                       */import"./index.CTAGWh-w.js";const L=typeof window<"u",f={gameState:{word:"",wordArr:["","","","",""],swaps:[],guess:"",valid:[[{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null}],[{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null}],[{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null}],[{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null}],[{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null},{char:"",isValid:null}]],isWin:!1,isRestarting:!0,currentLetter:0,currentRow:0},gameSettings:{Length:5,Tries:5,Language:"ES",dicName:null}},V={tries:0,success:0,fails:0},c=S(L?JSON.parse(localStorage.getItem("F-Shuffle")||JSON.stringify(f)):f);S(L?JSON.parse(localStorage.getItem("F-ShuffleStadistic")||JSON.stringify(V)):V);const G=S({valid:null,custom:null}),F={apiKey:"AIzaSyAwmC0jcBFmuMxYJaGS1wjdiuOSPYYSZWo",authDomain:"dictionaries-15fdf.firebaseapp.com",databaseURL:"https://dictionaries-15fdf-default-rtdb.firebaseio.com",projectId:"dictionaries-15fdf",storageBucket:"dictionaries-15fdf.appspot.com",messagingSenderId:"250956565323",appId:"1:250956565323:web:494f59d70d787ecc7c36ce",measurementId:"G-S3KRN2E2FZ"},b=P(F),A=D(b);$(b);const T=(a,e)=>{localStorage.setItem(a,JSON.stringify(e))},J=a=>JSON.parse(localStorage.getItem(a)||"{}"),B=a=>{if(!localStorage.getItem(a)){console.log("Storage not found");return}localStorage.removeItem(a)},m={set:T,get:J,remove:B},O=a=>{const e=R(50),t=a.split(""),r=[];for(let n=0;n<t.length-1;n++){const s=(n+e)%t.length;r.push([n,s]),[t[n],t[s]]=[t[s],t[n]]}return{word:a,swaps:r,shuffled:t.join("")}},z=(a,e)=>{const t=a.split("");for(let r=e.length-1;r>=0;r--){const[n,s]=e[r];[t[n],t[s]]=[t[s],t[n]]}return{word:t.join(""),arr:t}},R=a=>Math.floor(Math.random()*((a||100)+1)),C=async a=>(G.get(),!0),Z=(a,e,t)=>{const r=z(a,e);let n=[];for(let s=0;s<r.arr.length;s++)n.push(r.arr[s]===t[s]);return{result:n,isWin:n.every(Boolean)}},w={shuffle:O,generateRandom:R,verifyWord:C,comparingWord:Z},K=async(a,e)=>{try{const t=x(A,`${a}/gameDefault/d${e}`),n=(await I(t)).val(),s=w.generateRandom(n.length);return console.log(n[s]),n[s]}catch(t){throw console.log("Error fetching word:",t),t}},M=async(a,e,t)=>{},Y=async(a,e,t)=>{try{const r=x(A,`${a}/${e}`);return await j(r,t),console.log("Custom Dictionary set successfully"),!0}catch(r){throw console.log("Error setting custom Dictionary: ",r),r}},_={getWord:K,getValidWords:M,setCustomDictionary:Y},E=a=>{(a.endsWith("/")||a.endsWith(","))&&(a=a.slice(0,-1));let e=a.split("/").filter(t=>t!=="");if(e.length===0)throw new Error("Invalid Path: No Path encounter");return e=e.map(t=>t.replace(/^[^a-zA-Z0-9-_\,]+|[^a-zA-Z0-9-_\,]+$/g,"")),e},H=(a,e)=>{if(Array.isArray(e))throw new Error("Invalid Format: The object is an array");const t=E(a);for(let n=0;n<t.length-1;n++)if(t[n].includes(","))throw new Error("Invalid Path: The path contains a comma");let r=t[t.length-1];return{Navigation:t,firstPath:t[0],lastPath:r,lastValues:r.split(",")}},v={normalizePath:E,validatePath:H},U=(a,e)=>{const t=v.validatePath(a,e);if(t.lastValues.length>1)throw new Error("The last path expect a single value.");if(t.Navigation.length===1)return e[t.firstPath];let r=e;for(let s=0;s<t.Navigation.length-1;s++){const i=t.Navigation[s];if(!r[i])return;r=r[i]}const n=t.lastPath[0];if(r[n]!==void 0)return r[n]},q=(a,{value:e,data:t})=>{if(e===t)throw new Error("The value and data cannot be the same.");const r=v.validatePath(a,t),n=r.lastValues.length>1;let s=isNaN(Number(r.firstPath))?{...t}:[];if(r.Navigation.length===1)return s[r.firstPath]=e,s;if(!Array.isArray(e)&&r.lastValues.length>1)throw new Error(`The value expects an Array with ${r.lastValues.length} values.`);let i=s,u=i;for(let l=0;l<r.Navigation.length;l++){const h=r.Navigation[l];if(l===r.Navigation.length-1){if(!Array.isArray(e)&&n)throw new Error("The value must be an array when assigning to multiple keys.");if(r.lastValues.length===1){i[h]=e;break}return u=i,r.lastValues.forEach((W,k)=>{u[W]=e[k]}),s}i[h]===void 0&&(i[h]={}),u=i,i=i[h]}return s},Q=(a,e)=>{const t=v.validatePath(a,e);let r={...e};if(t.Navigation.length===1){const{[t.firstPath]:s,...i}=e;return i}let n=e;for(let s=0;s<t.Navigation.length;s++){const i=t.Navigation[s];if(!n[i])return console.log("No existe"),e;if(s===t.Navigation.length-1){delete n[i];break}n=n[i]}return r},X=()=>{console.log("hi")},tt=()=>{console.log("goodbye")},g={get:U,set:q,remove:Q,sayHello:X,sayGoodbye:tt},et=a=>{const e=c.get(),t=e.gameState,r=t.currentLetter;if(r>e.gameSettings.Length-1)return;let n=g.set(`gameState/valid/${t.currentRow}/${r}/char`,{value:a,data:e});g.set("gameState/currentLetter",{value:r+1,data:e}),c.set(n),n=null},at=()=>{const a=c.get(),e=a.gameState,t=e.currentLetter;if(t<=0)return;let r=g.set(`gameState/valid/${e.currentRow}/${t-1}/char`,{value:"",data:a});g.set("gameState/currentLetter",{value:t-1,data:a}),c.set(r),r=null},rt=()=>{const a=c.get(),e=a.gameState;if(e.currentLetter<a.gameSettings.Length){y.error("Field is not complete");return}const r=e.currentRow,n=e.valid[r].map(l=>l.char).join("");if(!w.verifyWord(n)){y.error("Invalid word");return}const i=w.comparingWord(e.word,e.swaps,n);for(let l=0;l<i.result.length;l++)e.valid[r][l].isValid=i.result[l];e.currentRow=r+1,e.currentLetter=0,e.isWin=i.isWin,e.guess=n;let u=g.set("gameState",{value:e,data:a});c.set(u),m.set("F-Shuffle",u)},p={typing:et,backspace:at,enter:rt};function nt(){const a=N(c),e=async()=>{try{const s=await _.getWord(a.gameSettings.Language,a.gameSettings.Length),i=w.shuffle(s);let u=g.set("gameState/word,wordArr,swaps",{value:[i.shuffled,i.shuffled.split(""),i.swaps],data:a});return await c.set(u),await m.set("F-Shuffle",u),!0}catch(s){return console.log(s),!1}},t=()=>{m.set("F-Shuffle",f),window.location.reload()},r=()=>{c.set(f),m.set("F-Shuffle",f)},n=s=>{/^[a-zA-ZñÑ]$/.test(s.key)&&p.typing(s.key),s.key==="Backspace"&&p.backspace(),s.key==="Enter"&&p.enter()};return d.useEffect(()=>(a?.gameState?.isWin?window?.removeEventListener("keydown",n):window?.addEventListener("keydown",n),()=>{window?.removeEventListener("keydown",n)}),[a?.gameState?.isWin]),d.useEffect(()=>{a?.gameState?.isRestarting&&(e(),a.gameState.isRestarting=!1)},[a?.gameState?.isRestarting]),{getWord:e,restartGame:t,restartSettings:r}}function st({data:a,id:e}){const t=d.useRef(null);return d.useEffect(()=>{a.isValid!==null?setTimeout(()=>{t.current.classList.add("validate"),setTimeout(()=>{t.current.setAttribute("data-valid",a.isValid||"none")},300)},e*170):(t.current.classList.remove("validate"),t.current.removeAttribute("data-valid"))},[a?.isValid]),o.jsx("span",{className:`box-letter br-6 f-center fs-6 fw-900 ${a.char?"active":""}`,"data-box":e,ref:t,children:a.char},e)}function it({data:a,id:e}){return o.jsx("div",{className:"game-row f-row g-2","data-row":e,children:a?.map((t,r)=>o.jsx(st,{data:t,id:r},r))})}const ot=({funct:a})=>{const e=d.useRef(null);return d.useEffect(()=>{const t=c.get();setTimeout(()=>{e.current.classList.remove("d-none")},t.gameSettings.Length*260)},[]),o.jsx("span",{className:"btn btn-blue br-6 w-max mx-auto mt-3 d-none",onClick:()=>a(),ref:e,children:"Play again"})};function wt(){const a=N(c),e=nt();return o.jsxs("section",{className:"game-container f-col g-2 mt-5 mx-auto",children:[o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"game-header f-row g-2 mx-auto",children:a.gameState.wordArr.map((t,r)=>o.jsx("span",{className:`box-letter br-6 f-center fs-6 fw-900 ${t?"":"load"}`,children:t||""},r))}),o.jsx("div",{className:"game-board f-col g-2 mx-auto mt-3",children:a.gameState.valid.map((t,r)=>o.jsx(it,{data:t,id:r},r))})]}),a?.gameState?.isWin?o.jsx(ot,{funct:e.restartGame}):null]})}export{wt as default};
